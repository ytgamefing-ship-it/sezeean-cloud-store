<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Store | Sezean Elite</title>
    <style>
        :root {
            --bg: #090b10;
            --card: rgba(21, 25, 33, 0.85);
            --primary: #38bdf8;
            --text: #ffffff;
            --text-dim: #94a3b8;
            --danger: #ff4757;
            --glass: rgba(255, 255, 255, 0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        
        body { 
            background: url('https://i.pinimg.com/736x/de/b5/13/deb513f325d81e493ee6936fea555228.jpg') no-repeat center center fixed; 
            background-size: cover; 
            color: var(--text); 
            overflow-x: hidden; 
            padding-bottom: 90px;
            min-height: 100vh;
        }

        body::after {
            content: ''; position: fixed; inset: 0;
            background: rgba(0, 0, 0, 0.75); z-index: -2;
        }

        /* --- UI UTILS --- */
        .page { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: none; flex-direction: column; overflow-y: auto; }
        .page-nav { padding: 20px; display: flex; align-items: center; gap: 15px; background: rgba(9, 11, 16, 0.9); backdrop-filter: blur(10px); position: sticky; top:0; z-index: 1100; border-bottom: 1px solid var(--glass); }
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 24px; padding: 25px; margin: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        
        /* --- LOGIN & MODAL --- */
        #loginOverlay { position: fixed; inset: 0; background: linear-gradient(-45deg, #090b10, #1e293b, #0f172a, #020617); background-size: 400% 400%; animation: meshGradient 10s ease infinite; z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px; }
        @keyframes meshGradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .login-box { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.1); padding: 40px 30px; border-radius: 30px; width: 100%; max-width: 380px; text-align: center; backdrop-filter: blur(25px); }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-box { background: #151921; border: 1px solid var(--danger); padding: 25px; border-radius: 20px; width: 85%; max-width: 300px; text-align: center; }

        /* --- ADMIN LOGIC --- */
        .admin-only { display: none !important; }
        body.is-admin .admin-only { display: flex !important; }
        .admin-only-inline { display: none; }
        body.is-admin .admin-only-inline { display: inline-block; }

        /* --- GRID & CARDS --- */
        .header-container { padding: 30px 20px; display: flex; justify-content: space-between; align-items: center; }
        .brand-text { font-size: 20px; font-weight: 900; letter-spacing: 3px; color: var(--primary); }
        .novel-grid { display: grid; gap: 15px; padding: 0 20px; }
        .novel-card { position: relative; border-radius: 20px; padding: 18px; display: flex; gap: 15px; align-items: center; cursor: pointer; background: #111; border: 1px solid var(--glass); overflow: hidden; }
        .novel-card::before { content: ''; position: absolute; inset: 0; background: rgba(5, 7, 10, 0.6); backdrop-filter: blur(2px); z-index: 1; }
        .cover-art-img { width: 70px; height: 90px; border-radius: 10px; object-fit: cover; position: relative; z-index: 2; }
        
        /* --- INPUTS --- */
        input, textarea { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; padding: 15px; color: white; margin-bottom: 15px; outline: none; }
        .btn-action { width: 100%; padding: 16px; border-radius: 15px; border: none; font-weight: 800; cursor: pointer; background: var(--primary); color: #000; transition: 0.3s; }
        .btn-action:active { transform: scale(0.95); }

        /* --- CHAPTER CARD (FIXED) --- */
        .ch-card { 
            background: rgba(255, 255, 255, 0.03); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            padding: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-radius: 15px; 
            margin: 0 20px 12px; 
            cursor: pointer;
            transition: 0.2s;
        }
        .ch-card:hover { background: rgba(255, 255, 255, 0.08); border-color: var(--primary); }
        .ch-card:active { transform: scale(0.98); background: rgba(56, 189, 248, 0.1); }
        
        .ch-info { flex: 1; } /* Biar text ambil sisa ruang */

        /* --- BOTTOM NAV --- */
        .nav-bar-bottom { position: fixed; bottom: 15px; left: 15px; right: 15px; height: 70px; background: rgba(21, 25, 33, 0.95); backdrop-filter: blur(15px); border-radius: 30px; display: flex; justify-content: space-around; align-items: center; border: 1px solid var(--glass); z-index: 900; }
        .add-btn { width: 55px; height: 55px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; color: #000; margin-top: -50px; border: 6px solid #090b10; box-shadow: 0 8px 20px rgba(56,189,248,0.3); }
        
        .filter-chip { padding: 6px 15px; background: rgba(255,255,255,0.05); border-radius: 20px; font-size: 12px; white-space: nowrap; cursor: pointer; border: 1px solid var(--glass); }
        .filter-chip.active { background: var(--primary); color: #000; font-weight: 700; }
        .genre-scroll { display: flex; gap: 8px; overflow-x: auto; scrollbar-width: none; margin: 0 20px 15px; }

        .genre-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .genre-cb { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 12px; font-size: 13px; cursor: pointer; }
    </style>
</head>
<body onload="checkSession()">

    <div id="loginOverlay" style="background: #020617; position: fixed; inset: 0; z-index: 10000; display: flex; align-items: center; justify-content: center; overflow: hidden;">
        <div style="position: absolute; width: 500px; height: 500px; background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, transparent 70%); filter: blur(50px); animation: orbit 15s linear infinite;"></div>
        
        <div class="login-box-pro">
            <div class="login-content">
                <h2 class="glitch-text" style="letter-spacing: 5px; color: white; font-weight: 900; margin-bottom: 5px;">MASUKAN USER</h2>
                <div style="height: 2px; width: 50px; background: var(--primary); margin: 0 auto 20px; border-radius: 10px; box-shadow: 0 0 10px var(--primary);"></div>
                
                <p style="color: var(--text-dim); font-size: 10px; letter-spacing: 2px; margin-bottom: 30px; font-weight: 700;">buat user apapun sesukamu</p>
                
                <div class="input-group">
                    <input type="text" id="userNameInput" placeholder="Enter Username..." autocomplete="off">
                    <div class="input-line"></div>
                </div>

                <div id="passArea" style="display: none; margin-top: 15px;">
                    <div class="input-group admin-glow">
                        <input type="password" id="passInput" placeholder="Admin Secret Key">
                        <div class="input-line" style="background: var(--danger);"></div>
                    </div>
                </div>

                <button class="btn-login-elite" onclick="handleLogin()">
                    <span>MASUK KE MENU NOVEL</span>
                </button>

                <p id="loginToggle" class="admin-toggle-link" onclick="toggleAdminLogin()">
                    <span>SWITCH TO ADMIN ACCOUNT</span>
                </p>
            </div>
        </div>
    </div>

    <style>
        .login-box-pro {
            position: relative;
            width: 90%;
            max-width: 400px;
            padding: 2px; /* Ruang untuk outline glow */
            background: linear-gradient(135deg, var(--primary), transparent, var(--primary));
            background-size: 200% 200%;
            border-radius: 30px;
            animation: borderRotate 4s linear infinite;
        }

        .login-content {
            background: #090b10;
            border-radius: 28px;
            padding: 50px 30px;
            text-align: center;
        }

        .input-group {
            position: relative;
            margin-bottom: 10px;
        }

        .input-group input {
            width: 100%;
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.05) !important;
            border-radius: 12px !important;
            padding: 18px !important;
            color: white !important;
            font-size: 14px;
            transition: 0.3s;
            outline: none;
        }

        .input-line {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: 0.4s ease;
            transform: translateX(-50%);
            box-shadow: 0 0 15px var(--primary);
        }

        .input-group input:focus + .input-line {
            width: 80%;
        }

        .btn-login-elite {
            width: 100%;
            margin-top: 30px;
            padding: 18px;
            border-radius: 15px;
            border: 1px solid var(--primary);
            background: transparent;
            color: var(--primary);
            font-weight: 900;
            letter-spacing: 2px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: 0.3s;
        }

        .btn-login-elite:hover {
            background: var(--primary);
            color: #000;
            box-shadow: 0 0 30px rgba(56, 189, 248, 0.4);
        }

        .admin-toggle-link {
            margin-top: 25px;
            color: var(--text-dim);
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: 0.3s;
        }

        .admin-toggle-link:hover {
            color: white;
            text-shadow: 0 0 10px white;
        }

        /* Animations */
        @keyframes borderRotate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes orbit {
            from { transform: rotate(0deg) translateX(100px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(100px) rotate(-360deg); }
        }

        .login-box-pro {
            animation: fadeInScale 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>

    <div id="deleteModal" class="modal-overlay">
        <div class="modal-box">
            <h3 style="color:var(--danger)">Hapus Data?</h3>
            <p id="modalMsg" style="font-size:13px; color:var(--text-dim); margin-top:10px;">Yakin hapus permanen?</p>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button style="flex:1; padding:12px; border-radius:10px; border:none; background:#2d333b; color:white;" onclick="closeDeleteModal()">BATAL</button>
                <button id="confirmDelBtn" style="flex:1; padding:12px; border-radius:10px; border:none; background:var(--danger); color:white;">HAPUS</button>
            </div>
        </div>
    </div>

<header class="header-container">
    <div class="brand-box">
        <div class="brand-text">Sezean Novel</div>
        <div class="brand-sub">BACA NOVEL INDONESIA DISINI</div>
    </div>
    
    <div id="userInitial" onclick="openProfileModal()"></div>
</header>

<div id="profileModal" class="p-modal-overlay">
    <div class="p-modal-content">
        <div class="p-modal-header">
            <h3>Update Profile</h3>
            <span class="p-close" onclick="closeProfileModal()">&times;</span>
        </div>
        <div class="p-modal-body">
            <p style="color: #94a3b8; font-size: 12px; margin-bottom: 15px;">Masukkan link URL foto profil (Direct Link)</p>
            <input type="text" id="imgUrlInput" placeholder="https://link-gambar.com/foto.jpg" oninput="previewImage(this.value)">
            
            <div id="previewContainer" style="margin: 15px 0;">
                <img id="imgPreview" src="" style="display:none; width:70px; height:70px; border-radius:12px; margin: 0 auto; border: 2px solid var(--primary); object-fit: cover;">
            </div>

            <div class="p-modal-btns">
                <button class="btn-cancel" onclick="closeProfileModal()">Batal</button>
                <button class="btn-save" onclick="applyProfile()">Simpan</button>
            </div>
        </div>
    </div>
</div>

<style>
    /* --- 1. BALIKIN ANIMASI BRAND (ROTATE GLOW) --- */
    .brand-box {
        position: relative; padding: 10px 20px; border-radius: 12px;
        overflow: hidden; display: flex; flex-direction: column; align-items: center;
        z-index: 1; background: #090b10;
    }
    .brand-box::before {
        content: ''; position: absolute; width: 180%; height: 180%;
        background: conic-gradient(transparent, transparent, var(--primary), transparent);
        animation: rotateGlow 4s linear infinite; z-index: -1;
    }
    .brand-box::after {
        content: ''; position: absolute; inset: 2px;
        background: #090b10; border-radius: 10px; z-index: -1;
    }
    @keyframes rotateGlow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    
    .brand-text { font-size: 1.3rem; font-weight: 900; text-transform: uppercase; color: #fff; letter-spacing: 1px; }
    .brand-sub { font-size: 0.6rem; color: var(--primary); letter-spacing: 1px; font-weight: bold; }

    /* --- 2. HEADER & PROFILE FIX --- */
    .header-container {
        display: flex; align-items: center; justify-content: space-between;
        padding: 15px 25px; background: rgba(9, 11, 16, 0.95);
        backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 1000;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    #userInitial {
        width: 45px; height: 45px; 
        background: linear-gradient(135deg, var(--primary), #ff8800);
        border-radius: 12px; cursor: pointer; border: 1px solid rgba(255, 255, 255, 0.2);
        background-size: cover; background-position: center; background-repeat: no-repeat;
        /* KILLER: Buang semua kemungkinan teks SE muncul */
        font-size: 0 !important; color: transparent !important;
    }

    /* --- 3. MODAL STYLE FIX (BIAR TENGAH & RAPI) --- */
    .p-modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.85);
        backdrop-filter: blur(8px); z-index: 9999;
        display: none; align-items: center; justify-content: center;
    }
    .p-modal-overlay.show { display: flex; }
    .p-modal-content {
        background: #151921; width: 85%; max-width: 380px; padding: 25px;
        border-radius: 25px; border: 1px solid rgba(56, 189, 248, 0.2);
        text-align: center; position: relative;
    }
    .p-modal-header h3 { color: var(--primary); margin-bottom: 10px; }
    .p-close { position: absolute; right: 20px; top: 15px; font-size: 24px; cursor: pointer; color: #666; }
    
    .p-modal-body input {
        width: 100%; padding: 12px; background: #000; border: 1px solid #333;
        border-radius: 10px; color: #fff; outline: none; text-align: center;
    }
    .p-modal-btns { display: flex; gap: 10px; margin-top: 15px; }
    .btn-save { background: var(--primary); color: #000; flex: 1; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
    .btn-cancel { background: #2d333b; color: #fff; flex: 1; padding: 12px; border-radius: 10px; border: none; cursor: pointer; }
</style>

<script>
    // FUNGSI UTAMA
    function openProfileModal() { document.getElementById('profileModal').classList.add('show'); }
    function closeProfileModal() { document.getElementById('profileModal').classList.remove('show'); }

    function previewImage(url) {
        const pre = document.getElementById('imgPreview');
        if(url.trim() !== "") { pre.src = url; pre.style.display = 'block'; }
        else { pre.style.display = 'none'; }
    }

    function applyProfile() {
        const url = document.getElementById('imgUrlInput').value.trim();
        const box = document.getElementById('userInitial');
        if (url !== "") {
            const temp = new Image();
            temp.src = url;
            temp.onload = () => {
                box.style.backgroundImage = `url('${url}')`;
                localStorage.setItem('user_profile_link', url);
                closeProfileModal();
            };
            temp.onerror = () => { alert("Link gambar rusak!"); };
        } else {
            box.style.backgroundImage = "linear-gradient(135deg, var(--primary), #ff8800)";
            localStorage.removeItem('user_profile_link');
            closeProfileModal();
        }
    }

    window.addEventListener('load', () => {
        const saved = localStorage.getItem('user_profile_link');
        if(saved) document.getElementById('userInitial').style.backgroundImage = `url('${saved}')`;
    });
</script>

<style>
    :root {
        --primary: #ffcc00;
        --text-dim: #aaa;
    }

    .welcome-container {
        margin: 20px;
        padding: 30px;
        background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.01) 100%);
        border-radius: 24px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(15px);
        display: flex;
        justify-content: space-between;
        align-items: center;
        overflow: hidden;
        position: relative;
        /* Efek melayang halus pada seluruh container */
        animation: floatingCard 6s ease-in-out infinite;
    }

    /* --- Keyframes Animasi --- */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }

    @keyframes shimmer {
        0% { background-position: -200% center; }
        100% { background-position: 200% center; }
    }

    @keyframes floatingCard {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }

    /* --- Sisi Kiri: User Info --- */
    .user-info {
        z-index: 1;
        animation: fadeInUp 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
    }

    .status-badge {
        display: inline-block;
        margin-bottom: 8px;
        padding: 4px 12px;
        background: rgba(255, 255, 255, 0.07);
        border-radius: 8px;
        font-size: 10px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: var(--text-dim);
        border: 1px solid rgba(255, 255, 255, 0.05);
        /* Animasi muncul setelah delay */
        animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }

    .user-info h2 {
        font-size: 32px;
        font-weight: 800;
        margin: 0;
        color: #fff;
    }

    #displayName {
        background: linear-gradient(90deg, var(--primary), #fff, var(--primary));
        background-size: 200% auto;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 15px rgba(255, 204, 0, 0.2);
        /* Animasi kilauan teks */
        animation: shimmer 4s linear infinite;
    }

    /* --- Sisi Kanan: Stats --- */
    .user-stats {
        display: flex;
        gap: 15px;
        z-index: 1;
        animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }

    .stat-item {
        padding: 12px 18px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 18px;
        min-width: 70px;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.3s ease;
    }

    .stat-item:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-5px);
        border-color: var(--primary);
    }

    .stat-value {
        display: block;
        font-size: 20px;
        font-weight: bold;
        color: var(--primary);
    }

    .stat-label {
        font-size: 9px;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    /* --- Hiasan Background --- */
    .bg-glow {
        position: absolute;
        right: -30px;
        bottom: -30px;
        width: 150px;
        height: 150px;
        background: var(--primary);
        filter: blur(90px);
        opacity: 0.12;
        z-index: 0;
    }
</style>

<div class="welcome-container">
    <div class="bg-glow"></div>
    
    <div class="user-info">
        <div class="status-badge" id="adminStatus">Reader Mode</div>
        <h2>Hi, <span id="displayName">Sezean</span></h2>
    </div>

    <div class="user-stats">
        <div class="stat-item">
            <span class="stat-value" id="libCount">12</span>
            <span class="stat-label">Library</span>
        </div>
        <div class="stat-item">
            <span class="stat-value">4</span>
            <span class="stat-label">Recent</span>
        </div>
    </div>
</div>

    <div style="margin: 0 20px 15px;"><input type="text" id="searchInput" placeholder="Cari judul..." oninput="renderLib()" style="margin-bottom:0"></div>

    <div class="genre-scroll">
        <div class="filter-chip active" onclick="filterByGenre('All', this)">All</div>
        <div class="filter-chip" onclick="filterByGenre('Action', this)">Action</div>
        <div class="filter-chip" onclick="filterByGenre('Romance', this)">Romance</div>
        <div class="filter-chip" onclick="filterByGenre('Fantasy', this)">Fantasy</div>
        <div class="filter-chip" onclick="filterByGenre('Echi', this)">Echi</div>
        <div class="filter-chip" onclick="filterByGenre('Isekai', this)">Isekai</div>
        <div class="filter-chip" onclick="filterByGenre('Horror', this)">Horror</div>
    </div>

    <div id="novelGrid" class="novel-grid"></div>

    <div id="detailPage" class="page">
        <div class="page-nav"><span onclick="closePage('detailPage')">‚úï</span><span id="detTitle">Detail</span></div>
        <div style="text-align:center; padding:40px 20px; background:radial-gradient(circle at top, #001a33 0%, #090b10 80%);">
            <img id="detailCover" src="" style="width:140px; height:200px; border-radius:12px; object-fit:cover;">
            <h1 id="novelDisplayTitle" style="margin-top:20px; font-size: 26px;"></h1>
            
            <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 13px;">
                <div onclick="handleLike()" style="cursor:pointer; background:rgba(255,255,255,0.05); padding:8px 15px; border-radius:20px;"><span id="detLikes">‚ù§Ô∏è 0</span></div>
                <div style="background:rgba(255,255,255,0.05); padding:8px 15px; border-radius:20px;">‚≠ê <span id="detRating">0.0</span></div>
            </div>
            <div id="detGenreContainer" style="margin-top:20px; display:flex; flex-wrap:wrap; justify-content:center; gap:8px;"></div>
        </div>

        <div style="padding: 25px; border-bottom: 1px solid var(--glass);">
            <p id="detDescription" style="color: var(--text-dim); font-size: 14px; line-height: 1.7;"></p>
        </div>

        <div id="chapterList" style="padding-bottom:100px; margin-top: 10px;"></div>

        <div class="nav-bar-bottom admin-only">
             <button class="btn-action" style="width: auto; padding: 10px 25px;" onclick="openPage('editorPage')">+ CHAPTER</button>
             <button class="btn-action" style="width: auto; background: var(--danger); color: white; padding: 10px 25px;" onclick="triggerDeleteNovel()">HAPUS</button>
        </div>
    </div>

    <div id="newNovelPage" class="page" style="background: radial-gradient(circle at top right, rgba(56, 189, 248, 0.1), #090b10);">
        <div class="page-nav" style="border-bottom: 1px solid rgba(56, 189, 248, 0.2); background: rgba(9, 11, 16, 0.95);">
            <span onclick="closePage('newNovelPage')" style="font-size: 24px; color: var(--primary); cursor: pointer;">‚úï</span>
            <span style="font-weight: 900; letter-spacing: 3px; background: linear-gradient(to right, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">UPLOAD NEW NOVEL</span>
        </div>

        <div style="padding: 20px 20px 100px;">
            <div class="glass-card" style="border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.02); backdrop-filter: blur(20px); border-radius: 30px; padding: 30px;">
                
                <div style="margin-bottom: 25px;">
                    <label style="display: block; font-size: 10px; font-weight: 900; color: var(--primary); letter-spacing: 2px; margin-bottom: 10px; margin-left: 5px;">NOVEL TITLE</label>
                    <input type="text" id="newNovelName" placeholder="Tulis judul yang epic..." 
                        style="background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); border-left: 4px solid var(--primary); border-radius: 12px; padding: 18px; font-weight: 600; transition: 0.3s; margin-bottom: 0;">
                </div>

                <div style="margin-bottom: 25px;">
                    <label style="display: block; font-size: 10px; font-weight: 900; color: var(--primary); letter-spacing: 2px; margin-bottom: 10px; margin-left: 5px;">COVER IMAGE URL</label>
                    <input type="text" id="newNovelCover" placeholder="https://imgur.com/your-art.jpg" 
                        style="background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); border-left: 4px solid var(--primary); border-radius: 12px; padding: 18px; font-weight: 600; transition: 0.3s; margin-bottom: 0;">
                </div>

                <div style="margin-bottom: 25px;">
                    <label style="display: block; font-size: 10px; font-weight: 900; color: var(--primary); letter-spacing: 2px; margin-bottom: 10px; margin-left: 5px;">STORY SYNOPSIS</label>
                    <textarea id="newNovelDesc" rows="5" placeholder="Gambarkan duniamu dalam beberapa kalimat..." 
                        style="background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); border-left: 4px solid var(--primary); border-radius: 12px; padding: 18px; font-weight: 500; line-height: 1.6; resize: none; transition: 0.3s; margin-bottom: 0;"></textarea>
                </div>

                <label style="display: block; font-size: 10px; font-weight: 900; color: var(--primary); letter-spacing: 2px; margin-bottom: 15px; margin-left: 5px;">SELECT GENRES</label>
                <div id="multiGenreContainer" class="genre-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 35px;">
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Action" style="display:none">
                        <span>Action</span>
                    </label>
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Romance" style="display:none">
                        <span>Romance</span>
                    </label>
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Fantasy" style="display:none">
                        <span>Fantasy</span>
                    </label>
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Isekai" style="display:none">
                        <span>Isekai</span>
                    </label>
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Echi" style="display:none">
                        <span>Echi</span>
                    </label>
                    <label class="genre-cb-pro">
                        <input type="checkbox" value="Horror" style="display:none">
                        <span>Horror</span>
                    </label>
                </div>

                <button class="btn-action" onclick="createNewNovel()" 
                    style="background: linear-gradient(45deg, var(--primary), #0ea5e9); color: #000; padding: 20px; border-radius: 15px; font-size: 14px; letter-spacing: 2px; box-shadow: 0 10px 25px rgba(56, 189, 248, 0.3); border: none;">
                    üöÄ PUBLISH NOW
                </button>
            </div>
        </div>
    </div>

    <style>
        .genre-cb-pro {
            cursor: pointer;
            text-align: center;
        }
        .genre-cb-pro span {
            display: block;
            padding: 12px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            color: var(--text-dim);
            transition: 0.3s;
        }
        .genre-cb-pro input:checked + span {
            background: rgba(56, 189, 248, 0.15);
            border-color: var(--primary);
            color: var(--primary);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.2);
            transform: translateY(-2px);
        }
        input:focus, textarea:focus {
            border-color: var(--primary) !important;
            background: rgba(0,0,0,0.6) !important;
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.1);
        }
    </style>

    <div id="editorPage" class="page">
        <div class="page-nav"><span onclick="closePage('editorPage')">‚úï</span><span>Tulis Chapter</span></div>
        <div style="padding: 20px;">
            <input type="text" id="chapTitle" placeholder="Judul Chapter">
            <textarea id="chapContent" rows="15" placeholder="Isi cerita..."></textarea>
            <button class="btn-action" onclick="addChapter()">SIMPAN CHAPTER</button>
        </div>
    </div>

    <div id="readerPage" class="page">
        <div class="page-nav"><span onclick="closePage('readerPage')">‚Üê</span><span id="readTitle">Baca</span></div>
        <div id="readerContent" style="padding:30px; line-height:2; color:#cbd5e1; font-size:17px; white-space:pre-wrap;"></div>
    </div>

    <nav class="nav-bar-bottom">
        <span onclick="location.reload()" style="font-size:22px; cursor:pointer;">üè†</span>
        <div class="add-btn admin-only" onclick="openPage('newNovelPage')">+</div>
        <span onclick="logout()" style="font-size:22px; cursor:pointer;">üö™</span>
    </nav>

    <script>
        let lib = JSON.parse(localStorage.getItem('cs_v5_db')) || [];
        let curNovIdx = null;
        let selectedFilterGenre = 'All';
        const ADMIN_PASS = "AdminBahagiaBangetJanganLupaBuatKissYaww";
        let isAdminLogin = false;

        function toggleAdminLogin() {
            isAdminLogin = !isAdminLogin;
            document.getElementById('passArea').style.display = isAdminLogin ? 'block' : 'none';
        }

        function handleLogin() {
            const user = document.getElementById('userNameInput').value.trim();
            const pass = document.getElementById('passInput').value;
            if(!user) return alert("Nama wajib diisi!");
            if(isAdminLogin) {
                if(user.toLowerCase() === 'sezean' && pass === ADMIN_PASS) { setSession(user, true); }
                else { alert("Password Admin Salah!"); }
            } else { setSession(user, false); }
        }

        function setSession(name, admin) {
            sessionStorage.setItem('cloud_session', JSON.stringify({ name, isAdmin: admin }));
            location.reload();
        }

        function checkSession() {
            const saved = sessionStorage.getItem('cloud_session');
            if(saved) {
                const session = JSON.parse(saved);
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('displayName').innerText = session.name;
                document.getElementById('userInitial').innerText = session.name.substring(0,2).toUpperCase();
                if(session.isAdmin) {
                    document.body.classList.add('is-admin');
                    document.getElementById('adminStatus').innerText = "Admin Elite Mode";
                    document.getElementById('adminStatus').style.color = "var(--primary)";
                }
                renderLib();
            }
        }

        function logout() { sessionStorage.clear(); location.reload(); }

        function renderLib() {
            const grid = document.getElementById('novelGrid');
            const search = document.getElementById('searchInput').value.toLowerCase();
            grid.innerHTML = '';
            const filtered = lib.filter(n => {
                const ms = n.name.toLowerCase().includes(search);
                const mg = selectedFilterGenre === 'All' || (n.genres && n.genres.includes(selectedFilterGenre));
                return ms && mg;
            });
            filtered.forEach(n => {
                const realIdx = lib.indexOf(n);
                const card = document.createElement('div');
                card.className = 'novel-card';
                card.onclick = () => openDetail(realIdx);
                card.innerHTML = `<img src="${n.cover || ''}" class="cover-art-img"><div style="position:relative;z-index:2"><h3 style="color:var(--primary)">${n.name}</h3><p style="font-size:11px;color:var(--text-dim)">${n.chaps.length} Chapters</p></div>`;
                grid.appendChild(card);
            });
        }

        function openDetail(i) {
            curNovIdx = i;
            const n = lib[i];
            document.getElementById('detTitle').innerText = n.name;
            document.getElementById('novelDisplayTitle').innerText = n.name;
            document.getElementById('detailCover').src = n.cover || '';
            document.getElementById('detDescription').innerText = n.desc || "No synopsis.";
            document.getElementById('detLikes').innerText = `‚ù§Ô∏è ${n.likes || 0}`;
            document.getElementById('detRating').innerText = n.rating || "5.0";
            const genContainer = document.getElementById('detGenreContainer');
            genContainer.innerHTML = '';
            if(n.genres) n.genres.forEach(g => genContainer.innerHTML += `<span style="font-size:10px;background:var(--primary);color:black;padding:4px 10px;border-radius:5px;font-weight:bold;">${g}</span>`);
            renderChapters();
            openPage('detailPage');
        }

        function renderChapters() {
            const list = document.getElementById('chapterList');
            list.innerHTML = '';
            lib[curNovIdx].chaps.forEach((ch, ci) => {
                const div = document.createElement('div');
                div.className = 'ch-card';
                // EVENT CLICK DIPINDAH KE KOTAK (DIV UTAMA)
                div.onclick = (e) => {
                    // Cek biar kalau admin klik 'HAPUS', gak malah ngebuka chapter
                    if(e.target.innerText !== 'HAPUS') readChapter(ci);
                };
                div.innerHTML = `
                    <div class="ch-info"><b>${ci+1}.</b> ${ch.title}</div>
                    <span class="admin-only-inline" style="color:var(--danger); font-size:10px; font-weight:bold;" onclick="triggerDeleteChapter(${ci})">HAPUS</span>`;
                list.appendChild(div);
            });
        }

        function readChapter(ci) {
            const ch = lib[curNovIdx].chaps[ci];
            document.getElementById('readTitle').innerText = ch.title;
            document.getElementById('readerContent').innerText = ch.content;
            openPage('readerPage');
        }

        function createNewNovel() {
            const name = document.getElementById('newNovelName').value;
            const cover = document.getElementById('newNovelCover').value;
            const desc = document.getElementById('newNovelDesc').value;
            const gs = Array.from(document.querySelectorAll('#multiGenreContainer input:checked')).map(cb => cb.value);
            if(!name) return;
            lib.push({ name, cover, desc, genres: gs, chaps: [], likes: 0, rating: "5.0" });
            saveAndRefresh();
            closePage('newNovelPage');
            renderLib();
        }

        function addChapter() {
            const t = document.getElementById('chapTitle').value;
            const c = document.getElementById('chapContent').value;
            if(!t || !c) return;
            lib[curNovIdx].chaps.push({ title: t, content: c });
            saveAndRefresh();
            renderChapters();
            closePage('editorPage');
        }

        function triggerDeleteNovel() {
            document.getElementById('modalMsg').innerText = "Hapus novel ini?";
            document.getElementById('deleteModal').style.display = 'flex';
            document.getElementById('confirmDelBtn').onclick = () => {
                lib.splice(curNovIdx, 1);
                saveAndRefresh();
                closePage('detailPage');
                renderLib();
                closeDeleteModal();
            };
        }

        function triggerDeleteChapter(ci) {
            lib[curNovIdx].chaps.splice(ci, 1);
            saveAndRefresh();
            renderChapters();
        }

        function handleLike() {
            lib[curNovIdx].likes = (lib[curNovIdx].likes || 0) + 1;
            document.getElementById('detLikes').innerText = `‚ù§Ô∏è ${lib[curNovIdx].likes}`;
            saveAndRefresh();
        }

        function closeDeleteModal() { document.getElementById('deleteModal').style.display = 'none'; }
        function filterByGenre(g, el) { 
            selectedFilterGenre = g; 
            document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active')); 
            el.classList.add('active'); 
            renderLib(); 
        }
        function saveAndRefresh() { localStorage.setItem('cs_v5_db', JSON.stringify(lib)); }
        function openPage(id) { document.getElementById(id).style.display = 'flex'; }
        function closePage(id) { document.getElementById(id).style.display = 'none'; }
    </script>
</body>
</html>
